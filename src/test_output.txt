---------------------
src PlaceA dest PlaceF minimize km
---------------------
MATCH  p=(src:Place { name:'PlaceA'})-[:ROAD*1..100]->(dest:Place { name:'PlaceF'})
WHERE ALL(n IN nodes(p) WHERE 1=size(filter(m in nodes(p) WHERE m=n)))
RETURN p AS path,
reduce(km=0, r in relationships(p) | km+r.km) AS totalkm
ORDER BY totalkm ASC
LIMIT 1

---------------------
src PlaceA dest PlaceF minimize cost
---------------------
MATCH  p=(src:Place { name:'PlaceA'})-[:ROAD*1..100]->(dest:Place { name:'PlaceF'})
WHERE ALL(n IN nodes(p) WHERE 1=size(filter(m in nodes(p) WHERE m=n)))
RETURN p AS path,
reduce(cost=0, r in relationships(p) | cost+r.cost) AS totalcost
ORDER BY totalcost ASC
LIMIT 1

---------------------
src PlaceA dest PlaceF maximize km not pass PlaceH
---------------------
MATCH  p=(src:Place { name:'PlaceA'})-[:ROAD*1..100]->(dest:Place { name:'PlaceF'})
,(nodePlaceH:Place { name:'PlaceH' })
WHERE ALL(n IN nodes(p) WHERE 1=size(filter(m in nodes(p) WHERE m=n)))
AND NONE (n IN nodes(p) WHERE n=nodePlaceH)
RETURN p AS path,
reduce(km=0, r in relationships(p) | km+r.km) AS totalkm
ORDER BY totalkm DESC
LIMIT 1

---------------------
src PlaceA dest PlaceF minimize km pass PlaceB, PlaceE
---------------------
MATCH  p=(src:Place { name:'PlaceA'})-[:ROAD*1..100]->(dest:Place { name:'PlaceF'})
,(nodePlaceB:Place { name:'PlaceB' })
,(nodePlaceE:Place { name:'PlaceE' })
WHERE ALL(n IN nodes(p) WHERE 1=size(filter(m in nodes(p) WHERE m=n)))
AND nodePlaceB IN nodes(p)
AND nodePlaceE IN nodes(p)
RETURN p AS path,
reduce(km=0, r in relationships(p) | km+r.km) AS totalkm
ORDER BY totalkm ASC
LIMIT 1

---------------------
src PlaceA cycle minlength 4 km
---------------------
MATCH path = (src:Place { name:'PlaceA'})-[:ROAD*1..50]-(src:Place { name:'PlaceA'})
WITH path, src,reduce(km=0, r in relationships(path) | km+r.km) AS totalkm
WHERE ALL(x IN tail(nodes(path)) WHERE SINGLE(y IN tail(nodes(path)) WHERE x=y))
AND totalkm >= 4
RETURN path, totalkm
ORDER BY totalkm ASC, length(path) DESC
LIMIT 1

---------------------
src PlaceA cycle minlength 4 km pass PlaceH
---------------------
MATCH path = (src:Place { name:'PlaceA'})-[:ROAD*1..50]-(src:Place { name:'PlaceA'})
,(nodePlaceH:Place { name:'PlaceH' })
WITH path, src,reduce(km=0, r in relationships(path) | km+r.km) AS totalkm
,nodePlaceH
WHERE ALL(x IN tail(nodes(path)) WHERE SINGLE(y IN tail(nodes(path)) WHERE x=y))
AND totalkm >= 4
AND nodePlaceH IN nodes(path)
RETURN path, totalkm
ORDER BY totalkm ASC, length(path) DESC
LIMIT 1

---------------------
src PlaceA simplecycle minlength 5 km
---------------------
MATCH path = (src:Place { name:'PlaceA'})-[:ROAD*1..50]-(src:Place { name:'PlaceA'})
WITH path, src,reduce(km=0, r in relationships(path) | km+r.km) AS totalkm
WHERE SINGLE(y IN tail(nodes(path)) WHERE src=y)
AND totalkm >= 5
RETURN path, totalkm
ORDER BY totalkm ASC, length(path) DESC
LIMIT 1

---------------------
src PlaceA simplecycle minlength 5 km not pass PlaceD
---------------------
MATCH path = (src:Place { name:'PlaceA'})-[:ROAD*1..50]-(src:Place { name:'PlaceA'})
,(nodePlaceD:Place { name:'PlaceD' })
WITH path, src,reduce(km=0, r in relationships(path) | km+r.km) AS totalkm
,nodePlaceD
WHERE SINGLE(y IN tail(nodes(path)) WHERE src=y)
AND totalkm >= 5
AND NONE (n IN nodes(path) WHERE n=nodePlaceD)
RETURN path, totalkm
ORDER BY totalkm ASC, length(path) DESC
LIMIT 1

